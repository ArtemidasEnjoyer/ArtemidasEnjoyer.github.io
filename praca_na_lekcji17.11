CREATE TABLE IF NOT EXISTS pracownik3 (
	pracownik_id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
    nazwisko varchar(25) NOT NULL,
    stanowisko VARCHAR(25) NOT NULL,
    przelozony_nazwisko VARCHAR(25) NOT NULL,
    zatrudniony DATE NOT NULL,
    placa_pod DECIMAL(6,2),
    placa_dot DECIMAL(6,2),
    odzial_nazwa VARCHAR(20)
);

INSERT INTO pracownik3
	SELECT PRACOWNIK_ID,
    	pr.NAZWISKO,
    	pr.STANOWISKO,
		(SELECT NAZWISKO 
         FROM pracownik 
         WHERE pr.PRZELOZONY_ID = PRACOWNIK_ID) AS przelozony_nazwisko,
    	pr.ZATRUDNIONY,
    	pr.PLACA_POD,
    	pr.PLACA_DOD AS placa_dot,
    	od.NAZWA AS odzial_nazwa
    FROM pracownik pr
    LEFT JOIN oddzial od ON pr.ODDZIAL_ID = od.ODDZIAL_ID
   	
